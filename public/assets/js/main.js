(()=>{$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}});var e='<svg version="1.1" id="loader-1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="20px" height="20px" viewBox="0 0 50 50" style="enable-background:new 0 0 50 50;" xml:space="preserve">\n    <path fill="#fff" d="M25.251,6.461c-10.318,0-18.683,8.365-18.683,18.683h4.068c0-8.071,6.543-14.615,14.615-14.615V6.461z">\n      <animateTransform attributeType="xml" attributeName="transform" type="rotate" from="0 25 25" to="360 25 25" dur="0.6s" repeatCount="indefinite"></animateTransform>\n      </path>\n    </svg>';$(document).ready((function(){function t(){"open"==(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"open")?$("#loading_box").css({visibility:"visible",opacity:0}).animate({opacity:1},200):$("#loading_box").animate({opacity:0},200,(function(){$("#loading_box").css("visibility","hidden")}))}function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"success",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";$("#toast-container .toast").addClass("toast-"+e),$("#toast-container .toast-message_content").text(t),$("#toast-container").css("display","block"),setTimeout((function(){$("#toast-container").css("display","none"),$("#toast-container .toast").removeClass("toast-"+e),$("#toast-container .toast-message_content").text("")}),6e3)}$("body").off().on("click",".menu-mobile-icon button",(function(){$(".menu-mobile").hasClass("active")?($(".menu-mobile").removeClass("active"),$("body").removeClass("overflow-hidden")):($(".menu-mobile").addClass("active"),$("body").addClass("overflow-hidden"))})),$("body").on("click",".menu-mobile-close",(function(){$(".menu-mobile").removeClass("active"),$("body").removeClass("overflow-hidden")})),$("body").on("click",".navigation-nav .icon-down",(function(){$(this).closest("li").addClass("active"),$(this).closest("li").find("> .submenu").slideToggle()})),window.loadingBox=t,window.alert_show=i,$("body").on("submit",".tracuu-form",(function(t){t.preventDefault();var a={phone:$("#phone").val(),cccd:$("#cccd").val()},o=$(this).find("button[type='submit']");$.ajax({url:"/ajax/custormer-slot",type:"POST",dataType:"json",data:a,beforeSend:function(){o.prepend(e),o.attr("disabled",!0),o.addClass("loading"),o.closest("form").find(".error").text("")},success:function(e){e.error?"validation"==e.type&&o.closest("form").find(".error").text(e.message):($("#popup-tracuu").addClass("active"),$("#popup-tracuu").find(".popup-body").html(e.html)),o.find("#loader-1").remove(),o.attr("disabled",!1),o.removeClass("loading")},error:function(e){o.find("#loader-1").remove(),o.attr("disabled",!1),o.removeClass("loading"),i("error",e.message||"Có lỗi xảy ra, vui lòng thử lại sau")}})})),$("body").on("click","#close-popup-tracuu",(function(){$("#popup-tracuu").removeClass("active")}));new Date;function a(e){if(!e)return"";var t=function(e){return["CN","T2","T3","T4","T5","T6","T7"][e.getDay()]}(e),i=e.getDate().toString().padStart(2,"0"),a=(e.getMonth()+1).toString().padStart(2,"0"),o=e.getFullYear();return"".concat(t,", ").concat(i,"/").concat(a,"/").concat(o)}var o=window.matchMedia("(max-width: 768px)").matches,n=flatpickr("#departure-date",{dateFormat:"d/m/Y",minDate:"today",defaultDate:new Date,showMonths:o?1:2,locale:"vn",disableMobile:!0,onChange:function(e){if(e[0]){var t=e[0];$("#departure-date").val(a(t)),r.set("minDate",t),r.selectedDates[0]?$("#return-date").val(a(r.selectedDates[0])):$(".date-inputs").removeClass("active")}}}),r=flatpickr("#return-date",{dateFormat:"d/m/Y",minDate:n.selectedDates[0]||"today",showMonths:o?1:2,locale:"vn",disableMobile:!0,onChange:function(e){e[0]&&($(".date-inputs").addClass("active"),$("#return-date").val(a(e[0])))}}),s=$("#departure-date").data("date"),d=s?new Date(s):new Date;n.setDate(d),$("#departure-date").val(a(d)),r.set("minDate",d);var l=$("#return-date").data("date");if(l){var c=new Date(l);r.setDate(c),$("#return-date").val(a(c))}function p(e,i,a,o){var n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"replace",r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"";u(e),u(i),v(a),v(o),f();""==r&&(r=new URL(window.location.href)),"replace"==n&&t("open"),$.ajax({url:r,type:"GET",data:{startTime:u(e),endTime:u(i),minPrice:a,maxPrice:o,selectedFillters:f(),type:n},success:function(e){e.error||($(".content-right__top").html(e.topHtml),"replace"===e.type?$(".content-right__list").html(e.html):$(".content-right__list").append(e.html)),t("close")},error:function(e){console.error("Error fetching results:",e),t("close")}})}function u(e){var t=Math.floor(e/60),i=e%60;return String(t).padStart(2,"0")+":"+String(i).padStart(2,"0")}function f(){var e=[];return $(".company-item input:checked").each((function(){e.push($(this).attr("id"))})),e}function v(e){return new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND",maximumFractionDigits:0,currencyDisplay:"symbol"}).format(e).replace("₫","").trim()+" ₫"}function m(e,t){$("#min-price").val(v(e)),$("#max-price").val(v(t))}function h(e,t){var i=function(e){var t=Math.floor(e/60),i=e%60;return String(t).padStart(2,"0")+":"+String(i).padStart(2,"0")};$("#start-time").val(i(e)),$("#end-time").val(i(t))}$("body").on("click","#swap-locations",(function(){var e=$("#departure").val(),t=$("#destination").val(),i=$("#departure").data("name"),a=$("#destination").data("name");$("#departure").val(t),$("#destination").val(e),$("#departure").data("name",a),$("#destination").data("name",i),$("#departure-display").val(a),$("#destination-display").val(i)})),$("body").on("click",".add-date-return",(function(){$(this).parent().find("input").trigger("click")})),$("body").on("click",".remove-date",(function(){$("#return-date").val(""),$(".date-inputs").removeClass("active")})),$("body").on("submit","#booking-form",(function(t){t.preventDefault();var a={departure:$("#departure").val(),destination:$("#destination").val(),departureDate:$("#departure-date").val(),returnDate:$("#return-date").val()},o=$(this).find("button");$.ajax({url:"/ajax/find-slots",type:"POST",dataType:"json",data:a,beforeSend:function(){o.prepend(e),o.attr("disabled",!0),o.addClass("loading")},success:function(e){e.error?(i("error",e.message),o.find("#loader-1").remove(),o.attr("disabled",!1),o.removeClass("loading")):window.location.href=e.redirectUrl},error:function(e){o.find("#loader-1").remove(),o.attr("disabled",!1),o.removeClass("loading"),i("error",e.message||"Có lỗi xảy ra, vui lòng thử lại sau")}})})),m(0,2e6),$("#price-slider").slider({range:!0,min:0,max:2e6,values:[0,2e6],step:5e3,slide:function(e,t){m(t.values[0],t.values[1])},stop:function(e,t){clearTimeout(window.priceSliderTimeout),window.priceSliderTimeout=setTimeout((function(){var e=$("#time-slider").slider("values");p(e[0],e[1],t.values[0],t.values[1])}),400)}}),$("#time-slider").slider({range:!0,min:0,max:1440,values:[0,1440],step:30,slide:function(e,t){h(t.values[0],t.values[1])},stop:function(e,t){clearTimeout(window.sliderTimeout),window.sliderTimeout=setTimeout((function(){var e=$("#price-slider").slider("values");p(t.values[0],t.values[1],e[0],e[1])}),400)}}),h(0,1440),$("body").on("click",".sidebar .button-toggle",(function(){var e=$(this);e.closest(".sidebar-section").find(".section-content").slideToggle(300,(function(){$(this).is(":visible");e.find("svg").toggleClass("rotate-180")}))})),$(".sidebar-section .search-input").on("input",(function(){var e=$(this).val().toLowerCase().trim();$(this).parent().find(".company-item").each((function(){$(this).find("label").text().toLowerCase().includes(e)?$(this).show():$(this).hide()}))})),$("body").on("click",".remove-filter",(function(){var e=$(this).data("key"),t=$(this).data("attid");if(console.log(e,t),"times"==e){$("#time-slider").slider("values",[0,1440]),h(0,1440);var i=$("#price-slider").slider("values");p(0,1440,i[0],i[1])}else if("prices"==e){$("#price-slider").slider("values",[0,2e6]),m(0,2e6);var a=$("#time-slider").slider("values");p(a[0],a[1],0,2e6)}else $(".company-item input[type='checkbox']").each((function(){$(this).attr("id")==t&&($(this).prop("checked",!1),$(this).change())}));$(this).parent().remove()})),$("body").on("click",".load-more",(function(){$(this).prepend(e),$(this).attr("disabled",!0),$(this).addClass("loading");var t=new URL(window.location.href),i=$(this).data("page");t.searchParams.set("page",i);var a=$("#time-slider").slider("values"),o=$("#price-slider").slider("values");$(this).remove(),p(a[0],a[1],o[0],o[1],"append",t)})),$('.company-item input[type="checkbox"]').on("change",(function(){var e=$(this).is(":checked");$(this).closest(".company-item").hasClass("parent")&&$(this).closest(".filter-item").find(".list-child input[type='checkbox']").prop("checked",e),clearTimeout(window.checkboxTimeout),window.checkboxTimeout=setTimeout((function(){var e=$("#time-slider").slider("values"),t=$("#price-slider").slider("values");p(e[0],e[1],t[0],t[1])}),400)})),$(".sidebar-section").find(".section-content").each((function(){$(this).is(":visible")&&$(this).closest(".sidebar-section").find(".button-toggle svg").addClass("rotate-180")})),$(".product-detail__content-item.product-images").each((function(){var e=$(this).find(".mySwiper")[0],t=$(this).find(".mySwiper2")[0],i=new Swiper(e,{spaceBetween:10,slidesPerView:5,freeMode:!0,watchSlidesProgress:!0});new Swiper(t,{spaceBetween:10,navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"},thumbs:{swiper:i}})})),$("body").on("click",".product-detail__tab-item",(function(){var e=$(this).data("tab");$(this).closest(".product-detail").find(".product-detail__tab-item").removeClass("active"),$(this).addClass("active"),$(this).closest(".product-detail").find(".product-detail__content-item").removeClass("active"),$(this).closest(".product-detail").find(".product-detail__content-item."+e).addClass("active")})),$("body").on("click",".open-information",(function(){$(this).toggleClass("active"),$(this).closest(".border-box").find(".product-detail").toggleClass("active")})),$("body").on("click",".close-information",(function(){$(this).closest(".border-box").find(".open-information").removeClass("active"),$(this).closest(".border-box").find(".product-detail").removeClass("active")})),$("body").on("click",".open-child",(function(){$(this).toggleClass("active"),$(this).closest(".filter-item").find(".list-child").toggleClass("active")})),$("body").on("click",".open-popup",(function(){var e=$(this).data("product-id"),t=$(this).data("product-name"),i=$(this).data("product-price"),a=$(this).data("product-price-format"),o=$(this).data("brand-name");$("#popup-booking").find(".product-id").val(e),$("#popup-booking").find(".product-name").text(t),$("#popup-booking").find(".product-price").text(a),$("#popup-booking").find(".brand-name").text(o),$("#popup-booking").find(".total-price").text(a),$("#popup-booking").find("input.product-price").val(i),$("#popup-booking").addClass("active"),$("#popup-booking").find(".from").text($("#departure-display").val()),$("#popup-booking").find(".to").text($("#destination-display").val()),$("#popup-booking").find(".time").text($("#departure-date").val()),$("#popup-booking").find("button[type='submit']").data("isShowReturn")&&($("#popup-booking").find(".time").text($("#return-date").val()),$("#popup-booking").find(".from").text($("#destination-display").val()),$("#popup-booking").find(".to").text($("#departure-display").val()));var n=$(this).closest(".border-box").find(".info-location").data("locations");if(n&&n.length>0){var r="",s=n.filter((function(e){return"pickup"===e.type})),d=n.filter((function(e){return"pickup"===e.type})).slice(0,1)[0];$.each(s,(function(e,t){r+='<option value="'.concat(t.id,'" data-transit="').concat(null==t?void 0:t.transit,'">').concat(t.time," - ").concat(t.name,"</option>")})),$("#popup-booking").find("select[name='pickup']").html(r),$("#popup-booking").find("select[name='pickup']").val((null==d?void 0:d.id)||0).change();var l="",c=n.filter((function(e){return"dropoff"===e.type})),p=n.filter((function(e){return"dropoff"===e.type})).slice(-1)[0];$.each(c,(function(e,t){l+='<option value="'.concat(t.id,'" data-transit="').concat(null==t?void 0:t.transit,'">').concat(t.time," - ").concat(t.name,"</option>\n        </div>")})),$("#popup-booking").find("select[name='dropoff']").html(l),$("#popup-booking").find("select[name='dropoff']").val((null==p?void 0:p.id)||0).change()}})),$("body").on("change",".select-location",(function(){$(this).find("option:selected").data("transit")?$(this).closest(".location-wrapper").find(".location-detail").removeClass("hidden"):$(this).closest(".location-wrapper").find(".location-detail").addClass("hidden")})),$("body").on("click",".close-popup",(function(){$("#popup-booking").find(".product-id").val(""),$("#popup-booking").removeClass("active")})),$("body").on("click",".btn-qty",(function(){var e=$(this).parent().find("input.quantity"),t=parseInt(e.val());$(this).hasClass("btn-minus")?t>1&&t--:$(this).hasClass("btn-plus")&&t++,e.val(t);var i=$("#popup-booking").find("input.product-price").val();$("#popup-booking").find(".total-price").text(v(t*i))})),$("body").on("submit",".form-booking",(function(t){t.preventDefault();var a=$(this).find("button[type='submit']"),o=a.data("isShowReturn"),n=$(this).find("select[name='pickup']").val(),s=$(this).find("select[name='dropoff']").val(),d=$(this).find('textarea[name="pickup_detail"]').val(),l=$(this).find('textarea[name="dropoff_detail"]').val(),c={departure:o?$("#destination").val():$("#departure").val(),destination:o?$("#departure").val():$("#destination").val(),departureDate:o?$("#return-date").val():$("#departure-date").val(),returnDate:$("#return-date").val(),productId:$(this).find(".product-id").val(),quantity:$(this).find(".quantity").val(),name:$(this).find("input[name='name']").val(),phone:$(this).find("input[name='phone']").val(),cccd:$(this).find("input[name='cccd']").val(),pickUpId:n,dropOffId:s,pickUpAddress:d,dropOffAddress:l};$.ajax({url:"/ajax/place-order",type:"POST",dataType:"json",data:c,beforeSend:function(){a.prepend(e),a.attr("disabled",!0),a.addClass("loading"),a.closest("form").find(".error").text("")},success:function(e){e.error?"validation"==e.type&&a.closest("form").find(".error").text(e.message):(i("success",e.message),$("#popup-booking").removeClass("active"),$("#popup-booking").find('textarea[name="pickup_detail"]').val(""),$("#popup-booking").find('textarea[name="dropoff_detail"]').val(""),r.selectedDates[0]&&!o&&(a.data("isShowReturn",1),clearTimeout(window.checkboxTimeout),window.checkboxTimeout=setTimeout((function(){var e=$("#time-slider").slider("values"),t=$("#price-slider").slider("values"),i=new URL(window.location.href);i.searchParams.set("isShowReturn",1),p(e[0],e[1],t[0],t[1],"replace",i)}),400))),a.find("#loader-1").remove(),a.attr("disabled",!1),a.removeClass("loading")},error:function(e){a.find("#loader-1").remove(),a.attr("disabled",!1),a.removeClass("loading"),i("error",e.message||"Có lỗi xảy ra, vui lòng thử lại sau")}})})),$("body").on("click",".open-change-time",(function(e){e.preventDefault(),$(this).closest(".change-time-box").hide(),$(".banner.search-page").show()})),$("body").on("click",".close-change-time",(function(e){e.preventDefault(),$(".change-time-box").show(),$(this).closest(".banner.search-page").hide()})),$("body").on("click",".open-filter",(function(e){e.preventDefault(),$(".content-left.mobile").addClass("active")})),$("body").on("click",".close-sidebar",(function(e){e.preventDefault(),$(".content-left.mobile").removeClass("active")}))}))})();